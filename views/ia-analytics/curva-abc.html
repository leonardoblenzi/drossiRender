<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <title>IA & Analytics ‚Äî Curva ABC</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="/css/dashboard.css">
  <link rel="stylesheet" href="/css/curva-abc.css">
</head>
<body class="curva-abc">
  <header class="account-bar">
    <div class="account-bar__left">
      <span class="logo">üü°</span>
      <span class="app-name">API Mercado Livre</span>
    </div>
    <div class="account-bar__right">
      <div class="account-bar__current">
        <span class="lbl">Conta:</span>
        <span id="account-current" class="val">Carregando...</span>
      </div>
      <button id="btn-status" class="account-bar__status" title="Ver status do token" type="button">Status</button>
      <button id="account-switch" class="account-bar__switch" title="Trocar de conta" type="button">Trocar Conta</button>
    </div>
  </header>

  <div class="page-header">
    <h1>Curva ABC</h1>
    <div class="sub">Top 5 A/B/C por per√≠odo, multicontas e filtro de log√≠stica.</div>
  </div>

  <div class="wrap">
    <!-- ===== Card de Filtros ===== -->
    <section class="card filter-card" style="cursor:default">
      <!-- Grid de filtros -->
      <div class="filters form-grid">
        <div class="form-group">
          <label for="fDateFrom">Data in√≠cio</label>
          <input id="fDateFrom" type="date" class="input">
        </div>

        <div class="form-group">
          <label for="fDateTo">Data fim</label>
          <input id="fDateTo" type="date" class="input">
        </div>

        <!-- Multicontas com layout melhorado -->
        <div class="form-group group-multicontas">
          <label for="fAccounts">Multicontas</label>
          <select id="fAccounts" class="input select-multi" multiple></select>
          <div id="accChips" class="chips chips--small" aria-live="polite"></div>
          <small class="muted help">Segure Ctrl/Cmd para m√∫ltiplas</small>
        </div>

        <div class="form-group">
          <label for="fFull">FULL</label>
          <select id="fFull" class="input">
            <option value="all">Todos</option>
            <option value="only">% FULL</option>
            <option value="skip">Sem FULL</option>
          </select>
        </div>

        <div class="form-group btn-search">
          <label>&nbsp;</label>
          <button id="btnPesquisar" class="btn primary" style="width:100%" type="button">Pesquisar</button>
        </div>
      </div>

      <!-- Toolbar (somente switches on/off) -->
      <div class="filter-toolbar">
        <div class="switch-group" id="switch-groupby">
          <button class="btn-switch" data-group="mlb_sku" type="button">SKU</button>
          <button class="btn-switch active" data-group="mlb" type="button">MLB</button>
        </div>
        <div class="switch-group" id="switch-metric">
          <button class="btn-switch active" data-metric="revenue" type="button">Valor</button>
          <button class="btn-switch" data-metric="units" type="button">Unidades</button>
        </div>
      </div>

      <!-- Rodap√© do card de filtros: dicas + export ao canto inferior direito -->
      <div class="filters-footer">
        <ul class="muted tips">
          <li>* Vendas canceladas n√£o s√£o consideradas</li>
          <li>* O valor de frete pago pelo comprador n√£o √© considerado nos c√°lculos</li>
          <li>* A op√ß√£o ‚ÄúTipo log√≠stico‚Äù aparece somente com a chave processada em MLB</li>
          <li>* Na Curva ABC por SKU somente s√£o consideradas as vendas de produtos que possuam SKU no ato destas</li>
        </ul>
        <div class="export-actions bottom">
          <button class="btn" id="btnExportCsv" title="Exportar CSV" type="button">CSV</button>
          <button class="btn" title="Exportar Excel (em breve)" type="button" disabled>Excel</button>
          <button class="btn" title="Exportar PDF (em breve)" type="button" disabled>PDF</button>
        </div>
      </div>
    </section>

    <!-- ===== Cards A/B/C com KPIs ===== -->
    <section class="cards kpi-minis">
      <div class="card clickable selected" data-curve="A" tabindex="0">
        <h3>Curva A</h3>
        <div class="muted" id="cardAmeta"></div>
        <div class="mini-kpi">
          <div><small>Unidades</small><b id="kA_units">‚Äî</b></div>
          <div><small>Valor</small><b id="kA_value">‚Äî</b></div>
          <div><small>Qtd. itens</small><b id="kA_items">‚Äî</b></div>
          <div><small>Ticket M√©dio</small><b id="kA_ticket">‚Äî</b></div>
          <div><small>Participa√ß√£o</small><b id="kA_share">‚Äî</b></div>
        </div>
      </div>

      <div class="card clickable" data-curve="B" tabindex="0">
        <h3>Curva B</h3>
        <div class="muted" id="cardBmeta"></div>
        <div class="mini-kpi">
          <div><small>Unidades</small><b id="kB_units">‚Äî</b></div>
          <div><small>Valor</small><b id="kB_value">‚Äî</b></div>
          <div><small>Qtd. itens</small><b id="kB_items">‚Äî</b></div>
          <div><small>Ticket M√©dio</small><b id="kB_ticket">‚Äî</b></div>
          <div><small>Participa√ß√£o</small><b id="kB_share">‚Äî</b></div>
        </div>
      </div>

      <div class="card clickable" data-curve="C" tabindex="0">
        <h3>Curva C</h3>
        <div class="muted" id="cardCmeta"></div>
        <div class="mini-kpi">
          <div><small>Unidades</small><b id="kC_units">‚Äî</b></div>
          <div><small>Valor</small><b id="kC_value">‚Äî</b></div>
          <div><small>Qtd. itens</small><b id="kC_items">‚Äî</b></div>
          <div><small>Ticket M√©dio</small><b id="kC_ticket">‚Äî</b></div>
          <div><small>Participa√ß√£o</small><b id="kC_share">‚Äî</b></div>
        </div>
      </div>

      <!-- Card de Total -->
      <div class="card total-kpi" id="cardTotal" tabindex="0">
        <h3>Faturamento total</h3>
        <div class="mini-kpi total">
          <div><small>Unidades</small><b id="kT_units">‚Äî</b></div>
          <div><small>Valor</small><b id="kT_value">‚Äî</b></div>
          <div><small>Qtd. itens</small><b id="kT_items">‚Äî</b></div>
          <div><small>Ticket M√©dio</small><b id="kT_ticket">‚Äî</b></div>
        </div>
      </div>
    </section>

    <!-- Top 5 por curva -->
    <section class="top3">
      <div class="card list" style="cursor:default">
        <h4>Top 5 A</h4>
        <ul id="listA"></ul>
      </div>
      <div class="card list" style="cursor:default">
        <h4>Top 5 B</h4>
        <ul id="listB"></ul>
      </div>
      <div class="card list" style="cursor:default">
        <h4>Top 5 C</h4>
        <ul id="listC"></ul>
      </div>
    </section>

    <!-- Tabela -->
    <section class="card" style="cursor:default">
      <div class="table-scroll" style="display:flex;gap:12px;align-items:center;justify-content:space-between">
        <strong>Itens</strong>
        <input id="fSearch" placeholder="Buscar por MLB, SKU ou t√≠tulo" class="input" style="max-width:320px">
      </div>
      <table id="grid">


  <thead>
    <tr>
      <th>√çndice</th>
      <th>MLB</th>
      <th>T√≠tulo</th>
      <th>Unidades</th>
      <th class="percent">Unid. (%)</th>
      <th class="num">Valor</th>
      <th class="percent">FATURAMENTO %</th>
      <th class="promo">PROMO</th>
      <th class="percent">% APLICADA</th>
      <th>ADS</th>
      <th class="num">Cliques</th>
      <th class="num">Impr.</th>
      <th class="num">Invest.</th>
      <th class="percent">ACOS</th>
      <th class="num">Receita Ads</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

      <div id="pager" style="margin-top:8px" class="pager-wrap muted"></div>
    </section>
  </div>
<!-- Painel lateral de progresso -->
<div id="abcProgress" class="abc-progress hidden" aria-live="polite">
  <div class="abc-progress__head">
    <strong id="abcProgressTitle">Processando relat√≥rio</strong>
    <button id="abcProgressClose" type="button" title="Fechar">√ó</button>
  </div>
  <div class="abc-progress__bar">
    <div class="abc-progress__bar-fill" style="width:0%"></div>
    <div class="abc-progress__bar-indet"></div>
  </div>
  <div id="abcProgressStep" class="abc-progress__step">Iniciando‚Ä¶</div>
  <ul id="abcProgressLog" class="abc-progress__log"></ul>
</div>

  <script src="/js/ia-analytics-curva-abc.js"></script>
</body>
</html>
